# راهنمای به‌روزرسانی دیتابیس برای سیستم مدیریت تصاویر پرسنل

## تغییرات مورد نیاز در دیتابیس Access

برای فعال‌سازی سیستم مدیریت تصاویر پرسنل، باید یک فیلد جدید به جدول **Personnel** اضافه کنید.

### مرحله 1: باز کردن دیتابیس

1. فایل `MyDatabase.accdb` را با Microsoft Access باز کنید
2. جدول **Personnel** را در حالت Design View باز کنید

### مرحله 2: اضافه کردن فیلد جدید

در انتهای لیست فیلدهای موجود، یک فیلد جدید با مشخصات زیر ایجاد کنید:

```
Field Name: PhotoPath
Data Type: Short Text
Field Size: 255
Required: No
Allow Zero Length: Yes
Description: مسیر فایل عکس پرسنل (بر اساس کد ملی)
```

### مرحله 3: ذخیره تغییرات

1. تغییرات را ذخیره کنید (Ctrl+S)
2. جدول را ببندید
3. دیتابیس را ببندید

---

## روش جایگزین (با SQL Query)

اگر ترجیح می‌دهید فیلد را با دستور SQL اضافه کنید:

1. در Microsoft Access، به قسمت **Create** بروید
2. روی **Query Design** کلیک کنید
3. پنجره Show Table را ببندید
4. به SQL View تغییر دهید
5. دستور زیر را وارد کنید:

```sql
ALTER TABLE Personnel ADD COLUMN PhotoPath TEXT(255);
```

6. دکمه Run (!) را بزنید

---

## ساختار ذخیره‌سازی تصاویر

تصاویر پرسنل در پوشه زیر ذخیره می‌شوند:

```
[App Directory]/PersonnelImages/
```

### قالب نام‌گذاری فایل‌ها

هر عکس با نام **کد ملی** پرسنل ذخیره می‌شود:

```
[NationalID].jpg
```

**مثال:**
- کد ملی: `0123456789`
- نام فایل: `0123456789.jpg`
- مسیر کامل: `[App Directory]/PersonnelImages/0123456789.jpg`

---

## قابلیت‌های سیستم مدیریت تصاویر

### 1. در فرم ثبت نام (FormPersonnelRegister)

- انتخاب عکس از فایل سیستم
- نمایش پیش‌نمایش عکس
- ذخیره خودکار با نام کد ملی
- حذف عکس قبل از ذخیره

### 2. در فرم ویرایش (FormPersonnelEdit)

- بارگذاری خودکار عکس موجود
- امکان تغییر عکس
- امکان حذف عکس
- به‌روزرسانی خودکار هنگام تغییر کد ملی

### 3. مدیریت فایل‌ها

- ذخیره با کیفیت بالا (90% JPEG)
- تبدیل خودکار فرمت‌های مختلف به JPG
- حذف عکس قبلی هنگام اضافه عکس جدید
- تغییر نام خودکار هنگام تغییر کد ملی

---

## نکات مهم

### فرمت‌های پشتیبانی شده

سیستم از فرمت‌های زیر پشتیبانی می‌کند:

- JPG / JPEG
- PNG
- BMP
- GIF

همه فرمت‌ها به طور خودکار به JPG تبدیل می‌شوند.

### محدودیت‌ها

- حداکثر طول مسیر: 255 کاراکتر
- فرمت ذخیره: JPG (کیفیت 90%)
- فیلد PhotoPath اختیاری است (NULL allowed)

### پشتیبان‌گیری

توصیه می‌شود قبل از اعمال تغییرات، پشتیبان از فایل دیتابیس تهیه کنید:

```
MyDatabase.accdb  →  MyDatabase_Backup_[Date].accdb
```

---

## تست عملکرد سیستم

بعد از اعمال تغییرات، موارد زیر را بررسی کنید:

1. ✅ ثبت پرسنل جدید با عکس
2. ✅ ثبت پرسنل جدید بدون عکس
3. ✅ بارگذاری پرسنل موجود با عکس
4. ✅ تغییر عکس پرسنل
5. ✅ حذف عکس پرسنل
6. ✅ تغییر کد ملی (باید نام فایل عکس هم تغییر کند)
7. ✅ نمایش تصویر پیش‌فرض زمانی که عکس ندارد

---

## پشتیبانی و رفع مشکل

برای هرگونه مشکل یا سؤال، به دستورالعمل‌های بالا مراجعه کنید یا با توسعه‌دهنده تماس بگیرید.

---

**تاریخ به‌روزرسانی:** 2026-02-06  
**نسخه:** 1.0.0